---
sidebar: sidebar
permalink: flexcache-hot-spot/flexcache-hotspot-remediation-ontap-config.html
keywords: key, words, here
summary: "You will have to configure the HDFA and the data LIFs appropriately to realize the benefits of this solution. This solution uses intracluster caching—the origin and HDFA are in the same cluster."
---

= Configuring HDFAs in ONTAP

:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
You will have to configure the HDFA and the data LIFs appropriately to realize the benefits of this solution. This solution uses intracluster caching—the origin and HDFA are in the same cluster.

This is an advanced configuration, so you will have to do this via the ONTAP CLI. There are two configurations you must use in the `flexcache create` command, and one you must make sure isn't configured:

- `-auto-provision-as`: If you tab out, the CLI will try to autofill this and set the value to flexgroup. Make sure this isn't configured. If it pops up, just delete it. 
- `-aggr-list`: Provide an aggregate, or list of aggregates, that reside on the node or subset of nodes you want to restrict the HDF to.
- `-aggr-list-multiplier`: This is how many constituents will be created per aggregate listed in the aggr-list option. If you have two aggregates listed, and set this value to two, you will end up with four constituents. We recommend up to 8 constituents per aggregate, but 16 is also ok.

== Examples
Let's walk through the configuration of two different HDFA configurations. The first will be a 2x2x2 Inter-SVM HDFA, and the second will be a 4x1x4 Intra-SVM HDFA.

=== Create a 2x2x2 Inter-SVM HDFA
To assist in configuring a 2x2x2 Inter-SVM HDFA as shown in Figure 1, let’s fill out a prep sheet, referring to figure 1 below.

image::FlexCache-Hotspot-HDFA-2x2x2-Inter-SVM-HDFA.svg[Figure 1: 2x2x2 Inter-SVM HDFA layout]

[cols="1,1,1,1,1,1"]
|===
|SVM|Nodes per HDF|Aggregates|Constituents per Node|Junction Path |Data LIF IP(s)

|svm1 |node1, node2 |aggr1, aggr2 |2 |/hotspot |192.168.0.11,192.168.0.12
|svm2 |node3, node4 |aggr3, aggr4 |2 |/hotspot |192.168.0.13,192.168.0.14
|===

==== Create the HDFs
Run the following command twice, once for each row in the <<table>>. Make sure you adjust the `vserver` and `aggr-list` values for the second iteration.

```ngsh
cache::> flexcache create -vserver svm1 -volume hotspot -aggr-list aggr1,aggr2 -aggr-list-multiplier 2 -origin-volume <origin_vol> -origin-vserver <origin_svm> -size <size> -junction-path /hotspot
```

=== Create the data LIFs
Run the command four times, creating two data LIFs per SVM on the nodes listed in the table. Make sure you adjust the values appropriately for each iteration.

```ngsh
cache::> net int create -vserver svm1 -home-port e0a -home-node node1 -address 192.168.0.11 -netmask-length 24
```
Now you need to configure your clients to utilize the HDFA appropriately. See how to do this in the client configuration section.

=== Create a 4x1x4 Intra-SVM HDFA
To assist in configuring a 2x2x2 Inter-SVM HDFA as shown in Figure 1, let’s fill out a prep sheet, referring to figure 2 below.

image::FlexCache-Hotspot-HDFA-4x1x4-Intra-SVM-HDFA.svg[Figure 2: 4x1x4 Intra-SVM HDFA layout]

[cols="1,1,1,1,1,1"]
|===
|SVM |Nodes per HDF |Aggregates |Constituents per Node |Junction Path |Data LIF IP(s)

|svm1 |node1 |aggr1 |4 |/hotspot1 |192.168.0.11
|svm1 |node2 |aggr2 |4 |/hotspot2 |192.168.0.12
|svm1 |node3 |aggr3 |4 |/hotspot3 |192.168.0.13
|svm1 |node4 |aggr4 |4 |/hotspot4 |192.168.0.14
|===

==== Create the HDFs
Run the following command four times, once for each row in the prep sheet. Make sure you adjust the `aggr-list` and `junction-path` values for each iteration.

```ngsh
cache::> flexcache create -vserver svm1 -volume hotspot1 -aggr-list aggr1 -aggr-list-multiplier 4 -origin-volume <origin_vol> -origin-vserver <origin_svm> -size <size> -junction-path /hotspot1
```

==== Create the data LIFs
Run the command four times, creating a total of four data LIFs in the SVM. There should be one data LIF per node. Make sure you adjust the values appropriately for each iteration.

```ngsh
cache::> net int create -vserver svm1 -home-port e0a -home-node node1 -address 192.168.0.11 -netmask-length 24
```

Now you need to configure your clients to utilize the HDFA appropriately. See how to do this in the next section.
